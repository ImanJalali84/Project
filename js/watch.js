let watches = [
    {
        id:1,
        watchName:'watch1',
        PriceAfterDiscount:156.00,
        PriceBeforeDiscount:260.00,
        colorImage : [{color : 'silver',image : "../image/watches/watch1/trending-products-popular1.jpg"}],
        new : true,
        sale : false,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:2,
        watchName:'watch2',
        PriceAfterDiscount:207.00,
        PriceBeforeDiscount:345.00,
        colorImage : [{color : 'silver',image : "../image/watches/watch2/2.jpg"},{color : 'sienna', image : '../image/watches/watch2/3.jpg'}],
        new : true,
        sale : false,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."

    },
    {
        id:3,
        watchName:'watch3',
        PriceAfterDiscount:356.00,
        PriceBeforeDiscount:445.00,
        colorImage : [{color : 'navy',image : "../image/watches/watch3/6.jpg"}],
        new : true,
        sale : false,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."

    },
    {
        id:4,
        watchName:'watch4',
        PriceAfterDiscount:466.40,
        PriceBeforeDiscount:530.00,
        colorImage : [{color : 'bisque',image : "../image/watches/watch4/15.jpg"}],
        new : true,
        sale : false,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."

    },
    {
        id:5,
        watchName:'watch5',
        PriceAfterDiscount:218.40,
        PriceBeforeDiscount:420.00,
        colorImage : [{color : 'chocolate',image : "../image/watches/watch5/8.jpg"},{color : 'navy', image : '../image/watches/watch5/6.jpg'}],
        new : true,
        sale : true,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:6,
        watchName:'watch6',
        PriceAfterDiscount:135.00,
        PriceBeforeDiscount:225.00,
        colorImage : [{color : 'steelblue',image : "../image/watches/watch6/9.jpg"},{color : 'bisque', image : '../image/watches/watch6/15.jpg'}],
        new : true,
        sale : true,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:7,
        watchName:'watch7',
        PriceAfterDiscount:156.60,
        PriceBeforeDiscount:174.00,
        colorImage : [{color : 'wheat',image : "../image/watches/watch7/18.jpg"},{color : 'silver', image : '../image/watches/watch7/13.jpg'}],
        new : false,
        sale : false,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:8,
        watchName:'watch8',
        PriceAfterDiscount:132.30,
        PriceBeforeDiscount:189.00,
        colorImage : [{color : 'dimgrey',image : "../image/watches/watch8/4.jpg"},{color : 'sienna', image : '../image/watches/watch8/12.jpg'}],
        new : false,
        sale : true,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:9,
        watchName:'watch9',
        PriceAfterDiscount:94.05,
        PriceBeforeDiscount:99.00,
        colorImage : [{color : 'black',image : "../image/watches/watch9/17.jpg"},{color : 'sienna', image : '../image/watches/watch9/3.jpg'}],
        new : false,
        sale : false,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:10,
        watchName:'watch10',
        PriceAfterDiscount:346.50,
        PriceBeforeDiscount:495.00,
        colorImage : [{color : 'silver',image : "../image/watches/watch10/19.jpg"},{color : 'palegoldenrod', image : '../image/watches/watch10/14.jpg'}],
        new : false,
        sale : true,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:11,
        watchName:'watch11',
        PriceAfterDiscount:86.00,
        PriceBeforeDiscount:215.00,
        colorImage : [{color : 'dimgray',image : "../image/watches/watch11/16.jpg"},{color : 'chocolate', image : '../image/watches/watch11/12.jpg'}],
        new : false,
        sale : false,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:12,
        watchName:'watch12',
        PriceAfterDiscount:135.00,
        PriceBeforeDiscount:150.00,
        colorImage : [{color : 'palegoldenrod',image : "../image/watches/watch12/14.jpg"},{color : 'bisque', image : '../image/watches/watch12/15.jpg'}],
        new : false,
        sale : false,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:13,
        watchName:'watch13',
        PriceAfterDiscount:144.00,
        PriceBeforeDiscount:360.00,
        colorImage : [{color : 'black',image : "../image/watches/watch13/10.jpg"},{color : 'chocolate', image : '../image/watches/watch13/8.jpg'}],
        new : false,
        sale : true,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:14,
        watchName:'watch14',
        PriceAfterDiscount:265.05,
        PriceBeforeDiscount:285.00,
        colorImage : [{color : 'steelblue',image : "../image/watches/watch14/9.jpg"},{color : 'black', image : '../image/watches/watch14/17.jpg'}],
        new : true,
        sale : true,
        best : true,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:15,
        watchName:'watch15',
        PriceAfterDiscount:239.04,
        PriceBeforeDiscount:249.00,
        colorImage : [{color : 'sienna',image : "../image/watches/watch15/3.jpg"},{color : 'navy', image : '../image/watches/watch15/6.jpg'}],
        new : false,
        sale : true,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    },
    {
        id:16,
        watchName:'watch16',
        PriceAfterDiscount:80.00,
        PriceBeforeDiscount:160.00,
        colorImage : [{color : 'bisque',image : "../image/watches/watch16/15.jpg"},{color : 'palegoldenrod',image : "../image/watches/watch16/13.jpg"},{color : 'silver', image : '../image/watches/watch16/19.jpg'}],
        new : true,
        sale : true,
        best : false,
        count:1,
        description : "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters."
    }
]




let $ = document


const mainHeader = $.querySelector('.header-down .container')
window.addEventListener('scroll',()=>{
    if(window.pageYOffset > 50){

    mainHeader.className = 'container header-position'
    }else{
        mainHeader.className = 'container'
    }
})

//    //////////////////////////////////////////////////Search Btn\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
const searchBtn = $.querySelector('.search_btn');
const searchBtnMobile = $.querySelector('.search-btn-mobile')
const modalSearch = $.querySelectorAll('.modal-search-container')
const closeModalBtn = $.querySelectorAll('.close-modal')
searchBtn.addEventListener('click', () => {
    modalSearch[1].style.display = 'block'
})
searchBtnMobile.addEventListener('click', () => {
    modalSearch[0].style.display = 'block'
})
closeModalBtn[1].addEventListener('click', () => {
    modalSearch[1].style.display = 'none'
}) 
closeModalBtn[0].addEventListener('click', () => {
    modalSearch[0].style.display = 'none'
}) 


//    //////////////////////////////////////////////////Tap Top\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

let scrollToTop = $.querySelector('.tap-top');
window.addEventListener('scroll', function() {
    if (window.pageYOffset > 300) {
        scrollToTop.style.display = "block"
    } else {
        scrollToTop.style.display = "none"
    }
});

scrollToTop.addEventListener('click', function() {
    window.scrollTo({
        top: 0 ,
        behavior: 'smooth'
    });
});





//    //////////////////////////////////////////////////Cart\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

const cartItems = $.querySelectorAll('.shopping-cart')
const countProductsElem = $.querySelector('.header-down .container .menu .menu-right .icon-menu .count-products-purchased')
const countProductsMobileElem = $.querySelector('.mobile-fix-option .cart-btn .count-products-purchased')
const checkOut = $.querySelector('.menu .menu-right .icon-menu .shopping-cart li .buttons .checkout')
let userBasket = []


function basketMenusGenerator(userBasketArray){
    cartItems.forEach(cartItem => {
        if(userBasketArray.length){
            cartItem.innerHTML = ''
            
            userBasketArray.forEach(function(watch){
                cartItem.insertAdjacentHTML('beforeend', `<li class="ng-star-inserted">
                        <div class="media">
                            <a href="watch.html?watch=${watch.id}"><img class="me-3" src="${watch.colorImage[0].image}" alt="silver"></a>
                            <div class="media-body">
                                <a href="watch.html?watch=${watch.id}"><h4>${watch.watchName}</h4></a>
                                <h4 ><span> ${watch.count} x ${formatPrice(watch.PriceAfterDiscount)} </span></h4>
                            </div>
                        </div>
                        <div class="close-circle" onclick="removeMenuFromBasket(${watch.id})"><a href="#"><i class="fa fa-times"></i></a></div>
                    </li>`)
                    })
                    cartItem.insertAdjacentHTML('beforeend',`<li>
                    <div class="total">
                        <h5>subtotal : <span>$00.00</span></h5>
                    </div>
                </li>
                <li>
                    <div class="buttons">
                        <a class="view-cart" href="cartpage.html">view cart</a>
                        <a class="checkout" href="" onclick="removeAllCart()">checkout</a></div>
                </li>`)

               }else{
                    cartItem.innerHTML = ''
                    cartItem.insertAdjacentHTML('beforeend','<h5>Your cart is currently empty.</h5>')
            }
    })
}



function setLocalStorage(selectedWatches){
    localStorage.setItem('cart', JSON.stringify(selectedWatches))
}
function getLocalStorage(){
    let localStorageWatches = JSON.parse(localStorage.getItem('cart'))
    if(localStorageWatches){
        userBasket = localStorageWatches
    } else {
        userBasket = []
    }
    countProductsElem.innerHTML = userBasket.length
    countProductsMobileElem.innerHTML = userBasket.length
    basketMenusGenerator(userBasket)
    calcTotalPrice(userBasket)
}


function removeMenuFromBasket (watchID){
    let localStorageWatches = JSON.parse(localStorage.getItem('cart'));
    userBasket = localStorageWatches;
    userBasket = userBasket.filter(function(watch){
        return watch.id !== watchID
    })
    countProductsElem.innerHTML = userBasket.length
    countProductsMobileElem.innerHTML = userBasket.length
    setLocalStorage(userBasket)
    basketMenusGenerator(userBasket)
    calcTotalPrice(userBasket)
    location.reload();
}
function removeAllCart(){
    userBasket = []
    localStorage.removeItem('cart')
    getLocalStorage(userBasket)
    location.reload();
}
function formatPrice (price){
    let formatted = parseFloat(price).toFixed(2);
    formatted = formatted.toString().replace('/\B(?=(\d{3})+(?!\d)',',')
    formatted = '$' + formatted
    return formatted;
}
function calcTotalPrice(userBasketArray) {
    let totalPriceValue = 0;
    userBasketArray.forEach(function (watch) {
        totalPriceValue += watch.PriceAfterDiscount * watch.count;
    });
    const cartTotalPriceElemTable = $.querySelector('.cart-section tfoot tr td h2')
    if(cartTotalPriceElemTable){
        cartTotalPriceElemTable.innerHTML = formatPrice(totalPriceValue);
        
    }
    const cartTotalPriceElem = $.querySelectorAll('.total h5 span');
    cartTotalPriceElem.forEach(price => {
        if (price) {
            price.innerHTML = formatPrice(totalPriceValue);
        }
    })
}
window.addEventListener('load', getLocalStorage)


//    //////////////////////////////////////////////////Body Page\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
const locationPageH2Elem = $.querySelector(".breadcrumb-section .page-title h2");
const watchName = $.querySelector('.watch-specifications h2');
const PriceBeforeDiscount = $.querySelector('.watch-specifications h4 del');
const PriceAfterDiscount = $.querySelector('.watch-specifications h3');
const discountPercent = $.querySelector('.watch-specifications h4 span');
const colorsUlElem = $.querySelector('.watch-specifications .color-variant');
let imgElement = $.querySelector('.section-page .container-section .big-image img');
const lowBtn = $.querySelector('.qty-box .input-group span button.quantity-left-minus');
const inputElement = document.querySelector(`input[name="quantity"]`);
const addBtn = $.querySelector('.qty-box .input-group span button.quantity-right-plus');
const imagesUlElem = $.querySelector('.section-page .container-section .more-imag ul');
const addToCartBtn = $.querySelector('.watch-specifications .product-buttons .btn-solid:nth-child(1)');
const addToWishlistBtn = $.querySelector('.watch-specifications .product-icon .wishlist-btn');
const descriptionPElem = $.querySelector('.more-details .tab-content p');


let locationPage = new URLSearchParams(location.search);
let mainProductNumber = locationPage.get('watch');
locationPageH2Elem.innerHTML = 'WATCH ' + mainProductNumber;
let mainProductObject = watches.find( watch => {
    return watch.id === Number(mainProductNumber);
})
if(mainProductObject){
    let colorLiElements = createColorLiElem(mainProductObject.colorImage);
    let imageLiElements = createImageLiElem(mainProductObject.colorImage);
    watchName.innerHTML = mainProductObject.watchName;
    PriceBeforeDiscount.innerHTML = formatPrice(mainProductObject.PriceBeforeDiscount) ;
    PriceAfterDiscount.innerHTML = formatPrice(mainProductObject.PriceAfterDiscount) ;
    discountPercent.innerHTML = Math.round(( (mainProductObject.PriceBeforeDiscount - mainProductObject.PriceAfterDiscount) / mainProductObject.PriceBeforeDiscount ) * 100) + '% Off'; 
    colorsUlElem.innerHTML = colorLiElements;
    imagesUlElem.innerHTML = imageLiElements;
    imgElement.setAttribute('src',mainProductObject.colorImage[0].image);
    descriptionPElem.innerHTML = mainProductObject.description;
}


function createColorLiElem(colors) {
    let colorLiElements = "";
    colors.forEach(colorObj => {
        colorLiElements += `<li class="ng-star-inserted" style="background-color: ${colorObj.color};"></li>`;
    });
    return colorLiElements;
}
const colorLiItems = $.querySelectorAll('.watch-specifications .color-variant li');
let selectedImage = null;
colorLiItems[0].classList.add('active')
colorLiItems.forEach((li, index) => {
    li.addEventListener('click', () => {
        selectedImage = mainProductObject.colorImage[index].image;
        imgElement.src = selectedImage;
        colorLiItems.forEach(item => {
            item.classList.remove('active');
        });
        li.classList.add('active');
        imageLiItems[index].classList.add('active');
        imageLiItems.forEach((item, i) => {
            if (i !== index) {
                item.classList.remove('active');
            }
        });
    });
});

addBtn.addEventListener('click', () => {
    let currentValue = parseInt(inputElement.value);
    currentValue++;
    inputElement.value = currentValue;
})
lowBtn.addEventListener('click', () => {
    if (inputElement.value > 0) {
        let currentValue = parseInt(inputElement.value);
        currentValue--;
        inputElement.value = currentValue;
    }else{
        inputElement.value = 0
    }
})

function createImageLiElem(images) {
    let imageLiElements = "";
    images.forEach(imageObj => {
        imageLiElements += `<li><img src="${imageObj.image}" alt="watch"></li>`;
    });
    return imageLiElements;
}
const imageLiItems = $.querySelectorAll('.section-page .container-section .more-imag ul li');
let selectedImageLi = null;
imageLiItems[0].classList.add('active')
imageLiItems.forEach((li, index) => {
    li.addEventListener('click', () => {
        selectedImage = mainProductObject.colorImage[index].image;
        imgElement.src = selectedImage;
        imageLiItems.forEach(item => {
            item.classList.remove('active');
        });
        li.classList.add('active');
        colorLiItems[index].classList.add('active');
        colorLiItems.forEach((item, i) => {
            if (i !== index) {
                item.classList.remove('active');
            }
        });
    });
});



function setLocalStorage(selectedWatches){
    localStorage.setItem('cart', JSON.stringify(selectedWatches))
}
function addToCart(event) {
    event.preventDefault();
    let menuExists = false;
    let localStorageWatches = JSON.parse(localStorage.getItem('cart')) || [];
    userBasket = localStorageWatches;
    userBasket.forEach(function(watch) {
        if (watch.id === Number(mainProductNumber)) {
            watch.count = Number(watch.count) + Number(inputElement.value);
            menuExists = true;
        }
    });
    if (!menuExists) {
        countProductsElem.innerHTML = userBasket.length
        countProductsMobileElem.innerHTML = userBasket.length
        mainProductObject.count = inputElement.value;
        userBasket.push(mainProductObject);
    }
    setLocalStorage(userBasket);
    window.location.href = 'cartpage.html';
}
addToCartBtn.addEventListener('click',addToCart)

function setLocalStorageWish(selectedWatches){
    localStorage.setItem('wishlist', JSON.stringify(selectedWatches))
}
function addToWishlist(event) {
    event.preventDefault();
    let menuExists = false;
    let localStorageWatches = JSON.parse(localStorage.getItem('wishlist')) || [];
    wishlist = localStorageWatches;
    wishlist.forEach(function(watch) {
        if (watch.id === Number(mainProductNumber)) {
            menuExists = true;
        }
    });
    if (!menuExists) {
        wishlist.push(mainProductObject);
    }
    setLocalStorageWish(wishlist);
}
addToWishlistBtn.addEventListener('click',addToWishlist)

const navDescription =$.querySelector('#ngb-nav-1');
const naveVideo =$.querySelector('#ngb-nav-2');
const navReview =$.querySelector('#ngb-nav-3');
const description = $.querySelector('.tab-pane.description')
const video = $.querySelector('.tab-pane.video')
const review = $.querySelector('.tab-pane.review')

navDescription.addEventListener('click', event => {
    event.preventDefault();
    description.classList.add('show');
    video.classList.remove('show');
    review.classList.remove('show');
    navDescription.classList.add('active');
    naveVideo.classList.remove('active');
    navReview.classList.remove('active');
})
naveVideo.addEventListener('click', event => {
    event.preventDefault();
    video.classList.add('show');
    description.classList.remove('show');
    review.classList.remove('show');
    navDescription.classList.remove('active');
    naveVideo.classList.add('active');
    navReview.classList.remove('active');
})
navReview.addEventListener('click', event => {
    event.preventDefault();
    review.classList.add('show');
    description.classList.remove('show');
    video.classList.remove('show');
    navDescription.classList.remove('active');
    naveVideo.classList.remove('active');
    navReview.classList.add('active');
})






for(let i = 0 ; i < watches.slice(0, 6).length ; i++){
    const currentWatch = watches[i];
    if (currentWatch && currentWatch.colorImage) {
        createBoxRelatedProducts(i+1, currentWatch.colorImage[0]?.image , currentWatch.watchName , currentWatch.PriceAfterDiscount , currentWatch.PriceBeforeDiscount , currentWatch.colorImage, currentWatch.sale,currentWatch.description);
    }
}
const watchesContainer = $.querySelector('.section-container .watches');

async function createBoxRelatedProducts (id, image, watchName, PriceAfterDiscount, PriceBeforeDiscount, colors, category,description){
    let colorLiElements = createColorLiElem2(colors);
    const watchContainer = document.createElement('div');
    await watchContainer.classList.add('watch');
    watchContainer.innerHTML = `<a href="watch.html?watch=${id}" class="imglink"><img src="${image}">
    <span class="new">NEW</span>
    ${category ? '<span class="sale">ON SALE</span>' : ''}
    <span class="cart-box">
        <button title="Add to cart" class="ng-star-inserted" onclick="addMenuToBasketArray(event, ${id})">
            <i class="ti-shopping-cart"></i>
        </button>
        <button title="Add to Wishlist" class="wish-btn" onclick="addWatchToWishlist(event, ${id})">
            <i class="ti-heart"></i>
        </button>
        <button title="Quick View" onclick="quickViewShow(event, ${id})">
            <i class="ti-search"></i>
        </button>
        <button title="Compare" onclick="addWatchToCompareList(event, ${id})">
            <i class="ti-reload"></i>
        </button>
    </span></a>
    <div class="star">
        <i class="fa fa-star" style="color: #edb867;"></i>
        <i class="fa fa-star" style="color: #edb867;"></i>
        <i class="fa fa-star" style="color: #edb867;"></i>
        <i class="fa fa-star" style="color: #edb867;"></i>
        <i class="fa fa-star" style="color: #edb867;"></i>
    </div>
    <div class="description-watch">
        <a href="watch.html?watch=${id}" class="watch-name">${watchName}</a>
        <h4 class="price">${formatPrice(PriceAfterDiscount)} <span>${formatPrice(PriceBeforeDiscount)}</span></h4>
        <ul class="colors">
            ${colorLiElements}
        </ul>
    </div>`;
    



    watchesContainer.appendChild(watchContainer);
    
    const colorLiItems = watchContainer.querySelectorAll('.related-products .section-container .watches .description-watch .colors .color');
    colorLiItems.forEach((li, index) => {
        li.addEventListener('click', () => {
            const selectedImage = colors[index].image;
            const imgElement = watchContainer.querySelector('img');
            imgElement.src = selectedImage;
        });
    });
}
function createColorLiElem2(colors) {
    let colorLiElements = "";
    colors.forEach(colorObj => {
        colorLiElements += `<li class="color" style="background-color: ${colorObj.color};"></li>`;
    });
    return colorLiElements;
}

const modalBackdrop = $.querySelector('.modal-backdrop')
const modal = $.querySelector('.modal')
const imgModal = $.querySelector('.modal-body .content .image img');
const nameWatch = $.querySelector('.product-right h2');
const PriceBeforeDiscountModal = $.querySelector('.product-right h3 del')
const PriceAfterDiscountModal = $.querySelector('.product-right h3 .mianPrice')
const coloresUlElem = $.querySelector('.product-right .color-variant')
const minusBtnModal = $.querySelector('.modal .qty-box .input-group span .quantity-left-minus')
const inputElemModal = $.querySelector('.product-right input[name="quantity"]')
const nextBtnModal = $.querySelector('.modal .qty-box .input-group span .quantity-right-plus')
const addToCartBtnModal = $.querySelector('.product-right a.add-cart')
const viewDetailBtn = $.querySelector('.product-right a.view-watch')
let watchSelect;
function quickViewShow (event, watchId){
    event.preventDefault();
    modal.style.display = "block"
    modalBackdrop.style.display = 'block'
    modalBackdrop.classList.add('show')
    watchSelect = watches.find(watch => {
        return watch.id === watchId
    })
    imgModal.setAttribute('src' , watchSelect.colorImage[0].image);
    nameWatch.innerHTML = watchSelect.watchName;
    PriceBeforeDiscountModal.innerHTML = formatPrice(watchSelect.PriceBeforeDiscount);
    PriceAfterDiscountModal.innerHTML = formatPrice(watchSelect.PriceAfterDiscount);
    coloresUlElem.innerHTML = ''
    watchSelect.colorImage.forEach( color => {
        coloresUlElem.insertAdjacentHTML('beforeend' , `<li class="sienna ng-star-inserted" style="background-color:${color.color};"></li>`)
    })
    addToCartBtnModal.addEventListener('click',() => {
        addToCartModal(watchSelect)
    })
    viewDetailBtn.setAttribute('href', `watch.html?watch=${watchId}`)
}
const closeModal = $.querySelector('.modal-content .modal-body .close')
closeModal?.addEventListener('click', event => {
    event.preventDefault();
    modal.style.display = "none"
    modalBackdrop.classList.remove('show')
    modalBackdrop.style.display = 'none'
    inputElemModal.value = 1
})
function addWatchToWishlist(event,watchId){
    event.preventDefault();
    let localStorageWatches = JSON.parse(localStorage.getItem('wishlist')) || [];
    Wishlist = localStorageWatches;
    let wishExists = false;
    Wishlist.forEach(function(watch) {
        if (watch.id === watchId) {
            wishExists = true;
        }
    });
    if (!wishExists) {
        let wish = watches.find(function(watch) {
            return watch.id === watchId;
        });
        Wishlist.push(wish);
    }
    setLocalStorageWish(Wishlist)
}
nextBtnModal.addEventListener('click', () => {
    let currentValue = parseInt(inputElemModal.value);
    currentValue++;
    inputElemModal.value = currentValue;
})
minusBtnModal.addEventListener('click', () => {
    if (inputElemModal.value > 0) {
        let currentValue = parseInt(inputElemModal.value);
        currentValue--;
        inputElemModal.value = currentValue;
    }else{
        inputElemModal.value = 0
    }
})
coloresUlElem.addEventListener('click', (event) => {
    if (event.target.tagName === 'LI') {
        const color = event.target.style.backgroundColor;
        const colorIndex = Array.from(coloresUlElem.children).indexOf(event.target);
        imgModal.setAttribute('src', watchSelect.colorImage[colorIndex].image);
    }
});

function addToCartModal(watchSelect) {
    let menuExists = false;
    let localStorageWatches = JSON.parse(localStorage.getItem('cart')) || [];
    userBasket = localStorageWatches;
    userBasket.forEach(function(watch) {
        if (watch.id === watchSelect.id) {
            watch.count = Number(watch.count) + Number(inputElemModal.value);
            menuExists = true;
        }
    });
    if (!menuExists) {
        countProductsElem.innerHTML = userBasket.length
        countProductsMobileElem.innerHTML = userBasket.length
        watchSelect.count = inputElemModal.value;
        userBasket.push(watchSelect);
    }
    setLocalStorage(userBasket);
}



















function addWatchToCompareList(event, watchId){
    event.preventDefault();
    let compareExists = false;
    let localStorageWatches = JSON.parse(localStorage.getItem('compare')) || [];
    compareList = localStorageWatches;
    compareList.forEach(function(watch) {
        if (watch.id === watchId) {
            compareExists = true;
        }
    });

    if (!compareExists) {
        let compare = watches.find(function(watch) {
            return watch.id === watchId;
        });

        compareList.push(compare);
    }
    
    setLocalStorageCompare(compareList)
}
function setLocalStorageCompare(selectedWatches){
    localStorage.setItem('compare', JSON.stringify(selectedWatches))
}

const watchesNewContainer = $.querySelector('.new-products .watches-new')
let watchesSlice = watches.slice(0, 6)
let currentPage = 1
function createBoxNewProducts (allWatches, watchesContainer , rowsCount, currentPage){
    watchesContainer.innerHTML = ''
    let endIndex = rowsCount * currentPage;
    let startIndex = endIndex - rowsCount;
    let paginatedWatches = allWatches.slice(startIndex, endIndex)
    paginatedWatches.forEach(watch => {
        const watchContainer = document.createElement('div');
        watchContainer.classList.add('watch-new');
    
        watchContainer.insertAdjacentHTML('beforeend', `<a href="watch.html?watch=${watch.id}">
        <img alt="watch" class="img-fluid" src="${watch.colorImage[0].image}">
        </a>
        <div class="media-body">
            <a href="watch.html?watch=${watch.id}"><h6>${watch.watchName}</h6></a>
            <h4> ${formatPrice(watch.PriceAfterDiscount)} <del><span  class="money"> ${formatPrice(watch.PriceBeforeDiscount)} </span></del>
            </h4>
        </div>`)
        watchesContainer.appendChild(watchContainer)
    })
}
createBoxNewProducts(watchesSlice, watchesNewContainer, 3, currentPage)

const nextPageBtn = $.querySelector('.new-products .main-title-border .change .ti-angle-right');
const prevPageBtn = $.querySelector('.new-products .main-title-border .change .ti-angle-left');
function changePage(){
    if(currentPage === 1){
        currentPage++;
    }else if(currentPage === 2){
        currentPage--;
    }
    createBoxNewProducts(watchesSlice, watchesNewContainer, 3, currentPage)
}
nextPageBtn.addEventListener('click', changePage)
prevPageBtn.addEventListener('click', changePage)














const collectionCollapse = $.querySelector('.collection-collapse-block');
const openCategory = $.querySelector('.collection-collapse-block .collapse-block-title');

openCategory.addEventListener('click', () => {
    collectionCollapse.classList.toggle('open');
})





const menubarLinkHome = $.querySelector(' .header-down .container .menu .menu-right .link-menu .home')
const menubarLinkHomechoose = $.querySelector(' .header-down .container .menu .menu-right .link-menu .home .choose')
const menubarLinkShop = $.querySelector(' .header-down .container .menu .menu-right .link-menu .shop')
const menubarLinkShopchoose = $.querySelector(' .header-down .container .menu .menu-right .link-menu .shop .choose')
const menubarLinkProducts = $.querySelector(' .header-down .container .menu .menu-right .link-menu .products')
const menubarLinkProductschoose = $.querySelector(' .header-down .container .menu .menu-right .link-menu .products .choose')
const menubarLinkFeatures = $.querySelector(' .header-down .container .menu .menu-right .link-menu .features')
const menubarLinkFeatureschoose = $.querySelector(' .header-down .container .menu .menu-right .link-menu .features .choose')
const menubarLinkPages = $.querySelector(' .header-down .container .menu .menu-right .link-menu .pages')
const menubarLinkPageschoose = $.querySelector(' .header-down .container .menu .menu-right .link-menu .pages .choose')
const menubarLinkBlogs = $.querySelector(' .header-down .container .menu .menu-right .link-menu .blogs')
const menubarLinkBlogschoose = $.querySelector(' .header-down .container .menu .menu-right .link-menu .blogs .choose')


const menubarLinkHomeLi = $.querySelector('.header-down .container .menu .menu-right .link-menu .home .choose li')
const menubarLinkHomeLiChoose = $.querySelector('.header-down .container .menu .menu-right .link-menu .home .choose li .choose-second')
const menubarLinkProductsLi = $.querySelector('.header-down .container .menu .menu-right .link-menu .products .choose li')
const menubarLinkProductsLiChoose = $.querySelector('.header-down .container .menu .menu-right .link-menu .products .choose li .choose-second')
const menubarLinkPagesLi1 = $.querySelector('.header-down .container .menu .menu-right .link-menu .pages .choose .li1')
const menubarLinkPagesLiChoose1 = $.querySelector('.header-down .container .menu .menu-right .link-menu .pages .choose .li1 .choose-second')
const menubarLinkPagesLi2 = $.querySelector('.header-down .container .menu .menu-right .link-menu .pages .choose .li2')
const menubarLinkPagesLiChoose2 = $.querySelector('.header-down .container .menu .menu-right .link-menu .pages .choose .li2 .choose-second')
const menubarLinkFeaturesLi = $.querySelectorAll('.header-down .container .menu .menu-right .link-menu .features .choose .column .title')
const menubarLinkFeaturesLiChoose = $.querySelectorAll('.header-down .container .menu .menu-right .link-menu div .column .subset')

function showChoose (choose){
    choose.classList.toggle('opensubmenu')
}
menubarLinkHome.addEventListener('click', event => {
    showChoose(menubarLinkHomechoose)
})
menubarLinkShop.addEventListener('click', () => {
    showChoose(menubarLinkShopchoose)
})
menubarLinkProducts.addEventListener('click', () => {
    showChoose(menubarLinkProductschoose)
})
menubarLinkFeatures.addEventListener('click', () => {
    showChoose(menubarLinkFeatureschoose)
})
menubarLinkPages.addEventListener('click', () => {
    showChoose(menubarLinkPageschoose)
})
menubarLinkBlogs.addEventListener('click', () => {
    showChoose(menubarLinkBlogschoose)
})
function showChooseLi (choose){
    choose.classList.toggle('opensubmenuli')
}
menubarLinkHomeLi.addEventListener('click', e => {
    e.stopPropagation();
    showChooseLi(menubarLinkHomeLiChoose)
})
menubarLinkProductsLi.addEventListener('click', e => {
    e.stopPropagation();
    showChooseLi(menubarLinkProductsLiChoose)
})
menubarLinkPagesLi1.addEventListener('click', e => {
    e.stopPropagation();
    showChooseLi(menubarLinkPagesLiChoose1)
})
menubarLinkPagesLi2.addEventListener('click', e => {
    e.stopPropagation();
    showChooseLi(menubarLinkPagesLiChoose2)
})

menubarLinkFeaturesLi.forEach( (li,index) => {
    li.addEventListener('click', e => {
        e.stopPropagation();
        if(menubarLinkFeaturesLiChoose[index].style.display === 'block'){
            menubarLinkFeaturesLiChoose[index].style.display = 'none';
        }else{
            menubarLinkFeaturesLiChoose[index].style.display = 'block';
        }
    })
})




const darkModeBtn = $.querySelector('header .dark-mode');
darkModeBtn.addEventListener('click', () => {
  $.body.classList.toggle('dark')
  if($.body.classList.contains("dark")){
    localStorage.setItem('theme', 'dark')
  }else{
    localStorage.setItem('theme', 'light')
  }
})
window.onload = function(){
    let localStrongeTheme = localStorage.getItem('theme')
    if(localStrongeTheme === 'dark'){
    $.body.classList.toggle("dark")
    }
}







const nav = $.querySelector('.nav')
const openNavBtn = $.querySelector('.section-page .container-section .filter-main-btn span');
const closeNavBtn = $.querySelector('.collection-mobile-back span');
openNavBtn.addEventListener('click', () => {
    nav.style.left = 0 
})
closeNavBtn.addEventListener('click', () => {
    nav.style.left = -350 + 'px'
})






const navBarBtn = $.querySelector('.header-down .container .menu .menu-right .icon-menu .icon-menu-bar i')
const navBarBtn2 = $.querySelector('.header-down .container .menu .menu-left .icon-menu-bar i')
const closeNavBarBtn = $.querySelector('.header-down .container .menu .menu-right .link-menu .back-btn')
const navBar = $.querySelector('.menu .menu-right .link-menu')
navBarBtn.addEventListener('click', () => {
    openMenu();
})
navBarBtn2.addEventListener('click', () => {
    openMenu();
})
closeNavBarBtn.addEventListener('click', () => {
    navBar.style.right = -300 + 'px'
})


function openMenu (){
    navBar.style.right = 0
}



const openNavBtnHeaderLeft = $.querySelector('.bar-style');
const closeNavBtnHeaderLeft = $.querySelector('header .sidenav .sidebar-back')
const navHeaderLeft = $.querySelector('#mySidenav')
const navHeaderLeftMore = $.querySelectorAll('.more');
const navHeaderLeftMoreUlElem = $.querySelectorAll('.more > ul')
const sidebarOverlay = $.querySelector('.sidebar-overlay')


openNavBtnHeaderLeft.addEventListener('click', e => {
    e.preventDefault();
    navHeaderLeft.classList.add('openSide')
})
closeNavBtnHeaderLeft.addEventListener('click', () => {
    navHeaderLeft.classList.remove('openSide')
})
sidebarOverlay.addEventListener('click', e => {
    e.preventDefault();
    navHeaderLeft.classList.remove('openSide')
})

navHeaderLeftMore.forEach( (li, index) => {
    li.addEventListener('click', e => {
        e.preventDefault();
        navHeaderLeftMoreUlElem[index].classList.toggle('opensub1')
    })
})